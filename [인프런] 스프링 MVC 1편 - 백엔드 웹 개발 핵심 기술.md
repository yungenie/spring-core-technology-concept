
# 🌱 스프링 MVC 1편 - 백엔드 웹 개발 핵심 기술
출저 : [`인프런 김영한 - 스프링 MVC 1편 백엔드 웹 개발 핵심 기술`](https://inf.run/xRKw)

<br>

## 목차
- [웹 애플리케이션 이해](#웹-애플리케이션-이해) 
<br>


## 웹 애플리케이션 이해

### 웹 서버, 웹 애플리케이션 서버

#### 웹 HTTP 기반

- 웹이라는 거는 다 http 기반으로 통신을 합니다.
- 웹 브라우저(클라이언트)에서 url 딱 치면 인터넷을 통해 서버에 접근하고 서버에서는 html만들어서 클라이언트에 내려줍니다. 그러면 웹 브라우저가 받은 html을 가지고 여러분 눈에 보여준다.
- 웹 세상에서는 HTTP 프로토콜을 기반으로 데이터를 주고 받습니다. 클라이언트에서 서버로 데이터를 전송할 때, 서버에서 클라이언트로 데이터를 응답할 때 다 HTTP라는 프로토콜 기반으로 동작을 합니다.
- 일반적으로 아는 html, 텍스트, 이미지, 음성, 영상, 파일, api json/xml, 서버간에 데이터를 주고 받을 때도 html 이런게 아니라 HTTP 프로토콜 기반으로 대부분 사용을 합니다.

#### 웹 서버 (Web Server)

- 웹 서버는 http 프로토콜을 기반으로 동작하는 서버 입니다.
- 웹 서버는 `정적`인 리소스(파일)를 제공하고 기타 부가 기능들을 제공합니다.
    - 특정 폴더에 html, css, js, 이미지, 영상과 같은 파일을 클라이언트가 웹 서버에 요청을 하면 http 프로토콜로 파일을 응답을 해줍니다.
    - 웹 서버도 사실은 프로그램을 실행하는 기능을 포함하기도 합니다. 플러그인을 설치해서 가능은 합니다.
- 웹 서버 : ex) NGINX, APACHE

#### 웹 애플리케이션 서버 (WAS, Web Application Server)

- 웹 애플리케이션 서버는 HTTP 요청이 오면 사용자에 따라서 다른 화면들도 보여줄 수 있습니다.
- 웹 애플리케이션 서버는 `동적`인 HTML 제공하며 **애플리케이션 로직**을 제공하는 서버 입니다.
    - 웹 서버의 기능을 대부분 포함하고 있습니다.
    - 웹 서버의 차이점은 프로그램 코드를 실행해서 애플리케이션 로직을 수행할 수 있습니다.
    - 특정 사용자마다  다르게 보여주는 동적인 HTML 파일 제공이 가능합니다.
    - 그래서 애플리케이션 코드를 실행하는데 조금 더 특화돼 있습니다.
- 웹 애플리케이션 서버 : ex) 톰캣(Tomcat) Jetty, Undertow

#### 웹 서버 vs 애플리케이션 서버

- 웹 서버는 정적 리소스를 제공하는 것이고, 와스는 애플리케이션 로직까지 실행할 수 있는 차이점이 있습니다.
    - 웹 서버 또한 애플리케이션 로직을 실행하는 기능을 포함하기도 하지만 와스가 애플리케이션 로직을 수행하는데 더 특화되어 있습니다.

#### 웹 시스템 구성

- Web Server - Was - DB
    - 정적 리소스만 제공하는 웹 서버는 잘 안죽지만, 와스는 잘 죽기 때문에 웹 서버를 앞에 두고 와스가 처리를 못해도 웹 서버를 앞에 두고 정적인 오류 html을 고객에게 보여줄 수 있도록 구성을 합니다.
- 자원 이용의 효율성 및 장애 극복, 배포 및 유지 보수의 편의성 때문에 웹 서버와 WAS를 분리해효율적인 분산 처리를 합니다.
   
    
#### 기타

- 웹 서버 기타 부가 기능?
    - 플러그인을 설치하면 프로그램을 실행하는 기능을 포함하기도 합니다.
- cdn 캐시 서버?
    - 콘텐츠 전송 네트워크 (content delivery network) 란 데이터 사용량이 많은 애플리케이션의 웹 페이지 로드 속도를 높이는 상호 연결된 서버 네트워크 입니다. 콘텐츠를 효율적으로 전달하기 위해 여러 노드를 가진 네트워크에 데이터를 저장하여 제공하는 시스템.

### 서블릿
- 목적
    - 웹 서버가 돌아가는 과정 이해
    - 서블릿을 사용했을 때는 어떤부분이 달라지는 지
    - 역사적 기술이 나오게 된 흐름은 자바 서블릿에 html 넣는 게 불편해서 jsp가 나타났습니다.
   
- jsp만 사용했을 때 처리 과정
    - jsp 파일을 자바코드로 변환이 되고 자바코드를 컴파일해서 컴파일된 파일이 인스턴스가 됩니다. 
    - 그 객체가 가지고 있는 서블릿의 서비스 메서드를 호출해서 처리 후 브라우저에 응답을 합니다.
    
- 웹 클라이언트의 요청을 처리할 수 있는 클래스 입니다.
- httpServelt을 상속해서 만들어집니다.
- 서블릿은 자바 코드 안에 html 넣을 수 있습니다.
- 서블릿이 처리되는 과정
    - 요청 url 들어오면 톰켓의 web.xml에서 해당 url에 맞춰 서블릿 매핑이 됩니다. 
    - 해당 서블릿 클래스에서 클라이언트의 요청에 대한 처리 후 결과를 jsp로 응답을 합니다.
- mvc 패턴
    - 결합도를 낮추고 응집도를 높힌다. 🔥
        - 하나의 클래스에 많은 기능을 담기 보다 목적을 하나만 둬서 그 목적만 처리 할 수 있고 해당 처리가 다른 곳에 영향이 안가게끔

### 멀티 쓰레드
- 서블릿은 쓰레드가 실행을 시켜줍니다.
- 요청마다 쓰레드가 생성되어 나타나는 단점
    - 고객 요청이 많아지면 쓰레드가 많이 생성되서 CPU, 메모리 임계점을 넘어서 서버가 죽는 경우가 생깁니다.
- 요청마다 쓰레드 생성의 단점 보안 (쓰레드 풀, Thread Pool)
    - 쓰레드 풀 내부에서 쓰레드를 관리할 수 있도록 쓰레드의 개수를 설정할 수 있습니다.
    - 톰캣은 최대 200개 기본, 쓰레드 풀에 생성 가능한 쓰레드의 최대치를 관리합니다.
    - 쓰레드가 필요하면 이미 생성되어 있는 쓰레드를 풀에서 꺼내서 사용합니다.
    - 사용을 종료하면 풀에 다시 반납합니다.
    - 최대 쓰레드를 모두 사용 중일 때는 요청을 거절하거나 특정 숫자 만큼 대기하도록 설정 가능합니다.
- 핵심
    - WAS가 멀티 쓰레드를 지원해줍니다.
    - 쓰레드 풀 설정 max thread로 처리를 할 수 있습니다. (개발자가 멀티 쓰레드 관련해서 코드로 신경을 쓰지 않아도 됩니다.)

## 서블릿
<img width="100%" alt="image" src="https://user-images.githubusercontent.com/28051638/229494672-c755ef01-ad7f-4187-a7a2-cd17d3f3df19.png">
- 서블릿 클래스가 싱글톤으로 관리됩니다.
